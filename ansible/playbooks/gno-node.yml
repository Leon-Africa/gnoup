- name: gno-node-setup
  hosts: gno-node
  roles:
     - role: gantsign.golang
       golang_gopath: '$HOME/workspace-go'
  become: true
  remote_user: ubuntu
  gather_facts: false
  vars:
    ansible_connection: aws_ssm
    ansible_aws_ssm_profile: default
    ansible_aws_ssm_bucket_name: gno-node-aws-ssm-connection-playbook
    ansible_aws_ssm_region: "eu-west-1"
  tasks:
    - name: pinging
      ping:

    - name: Clone Gno
      shell: |
        cd ../../../../home/
        git clone https://github.com/gnolang/gno.git
      register: result_clone_gno
 
    - name: Confirm Go instalation
      shell: |
        go version
      register: result_go_version
    
    - name: Build & Install Gnovm
      shell: |
        cd gno/gnovm
        make build
        make install
        gno --help
      register: result_gnovm

    - name: Build & Install Gnoland
      shell: |
        pwd
        cd gno/gno.land
        make build
        make install
      register: result_gnoland

    - name: Start Node
      shell: |
        pwd
        cd gno/gno.land
        gnoland start
      register: result_start_node
